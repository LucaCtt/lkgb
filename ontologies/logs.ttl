@prefix : <https://w3id.org/lkgb/log#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix time: <http://www.w3.org/2006/time#> .
@base <https://w3id.org/lkgb/log> .

<https://w3id.org/lkgb/log> rdf:type owl:Ontology ;
                                  owl:versionIRI <https://w3id.org/lkgb/log/1.0.0> ;
                                  <http://purl.org/dc/elements/1.1/creator> "Luca Cotti" ;
                                  <http://purl.org/dc/elements/1.1/description> "An ontology to represent log events." ;
                                  <http://purl.org/dc/elements/1.1/rights> "http://creativecommons.org/licenses/by/4.0/" ;
                                  <http://purl.org/dc/elements/1.1/title> "The LKGB log event ontology." ;
                                  <http://purl.org/vocab/vann/preferredNamespacePrefix> "log" .

#################################################################
#    Annotation properties
#################################################################

###  http://purl.org/dc/elements/1.1/creator
<http://purl.org/dc/elements/1.1/creator> rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/elements/1.1/description
<http://purl.org/dc/elements/1.1/description> rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/elements/1.1/rights
<http://purl.org/dc/elements/1.1/rights> rdf:type owl:AnnotationProperty .


###  http://purl.org/dc/elements/1.1/title
<http://purl.org/dc/elements/1.1/title> rdf:type owl:AnnotationProperty .


###  http://purl.org/vocab/vann/preferredNamespacePrefix
<http://purl.org/vocab/vann/preferredNamespacePrefix> rdf:type owl:AnnotationProperty .


#################################################################
#    Object Properties
#################################################################

###  https://w3id.org/lkgb/log#hasAddress
:hasAddress rdf:type owl:ObjectProperty ;
            rdfs:subPropertyOf :hasParameter ;
            rdfs:range :Address ;
            rdfs:comment "Relation between an Event and a Network Address." .


###  https://w3id.org/lkgb/log#hasApplication
:hasApplication rdf:type owl:ObjectProperty ;
                rdfs:subPropertyOf :hasParameter ;
                rdfs:range :Application ;
                rdfs:comment "Relation between an Event and an Application mentioned in it." .


###  https://w3id.org/lkgb/log#hasFile
:hasFile rdf:type owl:ObjectProperty ;
         rdfs:subPropertyOf :hasParameter ;
         rdfs:range :File ;
         rdfs:comment "Relation between an Event and a File mentioned in it." .


###  https://w3id.org/lkgb/log#hasParameter
:hasParameter rdf:type owl:ObjectProperty ;
              rdfs:domain :Event ;
              rdfs:range :Parameter ;
              rdfs:comment "Relation between an Event and a Parameter involved in it." .


###  https://w3id.org/lkgb/log#hasProcess
:hasProcess rdf:type owl:ObjectProperty ;
            rdfs:subPropertyOf :hasParameter ;
            rdfs:range :Process ;
            rdfs:comment "Relation between an Event and a Process mentioned in it." .


###  https://w3id.org/lkgb/log#hasSource
:hasSource rdf:type owl:ObjectProperty ;
           rdfs:domain :Event ;
           rdfs:range :Source ;
           rdfs:comment "Relation between an Event and the data Source it originates from (e.g. a file, or a log stream)." .


###  https://w3id.org/lkgb/log#hasSourceHost
:hasSourceHost rdf:type owl:ObjectProperty ;
               rdfs:domain :Event ;
               rdfs:range :SourceHost ;
               rdfs:comment "Relation between an Event and the Device it originates from." .


###  https://w3id.org/lkgb/log#hasSourceType
:hasSourceType rdf:type owl:ObjectProperty ;
               rdfs:domain :Source ;
               rdfs:range :SourceType ;
               rdfs:comment "Relation between a log Source and its SourceType (e.g., apache-access, kernel log)." .


###  https://w3id.org/lkgb/log#hasURL
:hasURL rdf:type owl:ObjectProperty ;
        rdfs:subPropertyOf :hasParameter ;
        rdfs:range :URL ;
        rdfs:comment "Relation between an Event and a URL mentioned in it." .


###  https://w3id.org/lkgb/log#hasUser
:hasUser rdf:type owl:ObjectProperty ;
         rdfs:subPropertyOf :hasParameter ;
         rdfs:range :User ;
         rdfs:comment "Relation between an Event and a User mentioned in it." .


#################################################################
#    Data properties
#################################################################


###  https://w3id.org/lkgb/log#address.ipv4
:address.ipv4 rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.address ;
              rdfs:comment "IPv4 address" .


###  https://w3id.org/lkgb/log#address.ipv6
:address.ipv6 rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.address ;
              rdfs:comment "IPv6 address" .

###  https://w3id.org/lkgb/log#address.hostname
:address.hostname rdf:type owl:DatatypeProperty ;
                  rdfs:subPropertyOf :parameter.address ;
                  rdfs:comment "Hostname associated with the address" .

###  https://w3id.org/lkgb/log#mac
:address.mac rdf:type owl:DatatypeProperty ;
             rdfs:subPropertyOf :parameter.address ;
             rdfs:comment "MAC address associated with the address" .


###  https://w3id.org/lkgb/log#address.port
:address.port rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.address ;
              rdfs:comment "Port" .

###  https://w3id.org/lkgb/log#address.city
:address.city rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.address ;
              rdfs:comment "City in which the address is located" .

###  https://w3id.org/lkgb/log#address.region
:address.region rdf:type owl:DatatypeProperty ;
                rdfs:subPropertyOf :parameter.address ;
                rdfs:comment "Region in which the address is located" .

###  https://w3id.org/lkgb/log#address.country
:address.country rdf:type owl:DatatypeProperty ;
                 rdfs:subPropertyOf :parameter.address ;
                 rdfs:comment "Country in which the address is located" .

###  https://w3id.org/lkgb/log#address.timezone
:address.timezone rdf:type owl:DatatypeProperty ;
                  rdfs:subPropertyOf :parameter.address ;
                  rdfs:comment "Timezone in which the address is located" .

###  https://w3id.org/lkgb/log#address.asn
:address.asn rdf:type owl:DatatypeProperty ;
             rdfs:subPropertyOf :parameter.address ;
             rdfs:comment "Autonomous System Number associated with the address" .

###  https://w3id.org/lkgb/log#address.org
:address.org rdf:type owl:DatatypeProperty ;
             rdfs:subPropertyOf :parameter.address ;
             rdfs:comment "Organization associated with the address" .


###  https://w3id.org/lkgb/log#application.name
:application.name rdf:type owl:DatatypeProperty ;
                  rdfs:subPropertyOf :parameter.application ;
                  rdfs:comment "Application name" .


###  https://w3id.org/lkgb/log#application.vendor
:application.vendor rdf:type owl:DatatypeProperty ;
                    rdfs:subPropertyOf :parameter.application ;
                    rdfs:comment "Application vendor" .


###  https://w3id.org/lkgb/log#application.version
:application.version rdf:type owl:DatatypeProperty ;
                     rdfs:subPropertyOf :parameter.application ;
                     rdfs:comment "Application version" .


# TODO: Choose whether to keep this
###  https://w3id.org/lkgb/log#appname
:appname rdf:type owl:DatatypeProperty ;
         rdfs:subPropertyOf :parameter ;
         rdfs:comment "Name of the application that generated the event" .


# TODO: Choose whether to keep this
###  https://w3id.org/lkgb/log#command
:command rdf:type owl:DatatypeProperty ;
         rdfs:subPropertyOf :parameter ;
         rdfs:comment "Command" .


###  https://w3id.org/lkgb/log#file.hashmd5
:file.hashmd5 rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.file ;
              rdfs:comment "File MD5 Hashsum" .


###  https://w3id.org/lkgb/log#file.line
:file.line rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File line number" .


###  https://w3id.org/lkgb/log#file.mode
:file.mode rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File mode flags" .


###  https://w3id.org/lkgb/log#file.name
:file.name rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File name" .


###  https://w3id.org/lkgb/log#file.path
:file.path rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File system path" .


###  https://w3id.org/lkgb/log#file.perm
:file.perm rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File permissions" .


###  https://w3id.org/lkgb/log#file.size
:file.size rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.file ;
           rdfs:comment "File size in octets" .


###  https://w3id.org/lkgb/log#message
:message rdf:type owl:DatatypeProperty ;
         rdfs:subPropertyOf :parameter ;
         rdfs:comment "Event message" .


###  https://w3id.org/lkgb/log#parameter
:parameter rdf:type owl:DatatypeProperty ;
           rdfs:domain :Parameter ;
           rdfs:comment "Generic parameter" .


###  https://w3id.org/lkgb/log#parameter.address
:parameter.address rdf:type owl:DatatypeProperty ;
                   rdfs:subPropertyOf :parameter ;
                   rdfs:domain :Address .

###  https://w3id.org/lkgb/log#parameter.timestamp
:parameter.timestamp rdf:type owl:DatatypeProperty ;
                     rdfs:subPropertyOf :parameter ;
                     rdfs:domain :TimeStamp .


###  https://w3id.org/lkgb/log#parameter.app
:parameter.application rdf:type owl:DatatypeProperty ;
                       rdfs:subPropertyOf :parameter ;
                       rdfs:domain :Application .


###  https://w3id.org/lkgb/log#parameter.file
:parameter.file rdf:type owl:DatatypeProperty ;
                rdfs:subPropertyOf :parameter ;
                rdfs:domain :File .


###  https://w3id.org/lkgb/log#parameter.proc
:parameter.process rdf:type owl:DatatypeProperty ;
                   rdfs:subPropertyOf :parameter ;
                   rdfs:domain :Process .


###  https://w3id.org/lkgb/log#parameter.url
:parameter.url rdf:type owl:DatatypeProperty ;
               rdfs:subPropertyOf :parameter ;
               rdfs:domain :URL .


###  https://w3id.org/lkgb/log#parameter.user
:parameter.user rdf:type owl:DatatypeProperty ;
                rdfs:subPropertyOf :parameter ;
                rdfs:domain :User .


###  https://w3id.org/lkgb/log#pid
:pid rdf:type owl:DatatypeProperty ;
     rdfs:subPropertyOf :parameter ;
     rdfs:comment "Process ID that generated the event" .


###  https://w3id.org/lkgb/log#pname
:pname rdf:type owl:DatatypeProperty ;
       rdfs:subPropertyOf :parameter ;
       rdfs:comment "Process name that generated the event" .


###  https://w3id.org/sepses/ns/log#pri
:priority rdf:type owl:DatatypeProperty ;
          rdfs:subPropertyOf :parameter ;
          rdfs:comment "Event priority (e.g. ERROR, WARN, DEBUG, CRIT)" .


###  https://w3id.org/sepses/ns/log#process.id
:process.id rdf:type owl:DatatypeProperty ;
            rdfs:subPropertyOf :parameter.process ;
            rdfs:comment "Process ID (pid)" .


###  https://w3id.org/sepses/ns/log#process.name
:process.name rdf:type owl:DatatypeProperty ;
              rdfs:subPropertyOf :parameter.process ;
              rdfs:comment "Process name" .


###  https://w3id.org/sepses/ns/log#process.tid
:process.tid rdf:type owl:DatatypeProperty ;
             rdfs:subPropertyOf :parameter.process ;
             rdfs:comment "Thread identifier of the process" .


###  https://w3id.org/lkgb/log#url.param
:url.param rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.url ;
           rdfs:comment "URL parameter" .


###  https://w3id.org/lkgb/log#url.url
:url.url rdf:type owl:DatatypeProperty ;
         rdfs:subPropertyOf :parameter.url ;
         rdfs:comment "Complete URL" .


###  https://w3id.org/lkgb/log#user.domain
:user.domain rdf:type owl:DatatypeProperty ;
             rdfs:subPropertyOf :parameter.user ;
             rdfs:comment "User account NT domain" .


###  https://w3id.org/lkgb/log#user.gid
:user.gid rdf:type owl:DatatypeProperty ;
          rdfs:subPropertyOf :parameter.user ;
          rdfs:comment "User account group ID (gid)" .


###  https://w3id.org/lkgb/log#user.group
:user.group rdf:type owl:DatatypeProperty ;
            rdfs:subPropertyOf :parameter.user ;
            rdfs:comment "User account group name" .


###  https://w3id.org/lkgb/log#user.uid
:user.uid rdf:type owl:DatatypeProperty ;
          rdfs:subPropertyOf :parameter.user ;
          rdfs:comment "User account ID (uid)" .


###  https://w3id.org/lkgb/log#user.name
:user.name rdf:type owl:DatatypeProperty ;
           rdfs:subPropertyOf :parameter.user ;
           rdfs:comment "User account name" .


#################################################################
#    Classes
#################################################################

###  https://w3id.org/lkgb/log#Event
:Event rdf:type owl:Class ;
       rdfs:comment "A single log event, such a log line in a log file." ;
       rdfs:label "Event" .


###  https://w3id.org/lkgb/log#Source
:Source rdf:type owl:Class ;
        rdfs:comment "A log source, such as an aggregation of logs from different applications (e.g., SysLog) or aggregation of several log files from different devices." ;
        rdfs:label "Source" .


# TODO: Check if this should be a class or a property
###  https://w3id.org/lkgb/log#SourceHost
:SourceHost rdf:type owl:Class ;
            rdfs:label "Source Host" ;
            rdfs:comment "The host/device which produced the source for this log event" .


# TODO: Check if this should be a class or a property
###  https://w3id.org/lkgb/log#SourceType
:SourceType rdf:type owl:Class ;
            rdfs:comment "The type of a log source, e.g., apache-access, kernel, syslog, audit, etc." ;
            rdfs:label "Source Type" .


###  https://w3id.org/lkgb/log#Parameter
:Parameter rdf:type owl:Class ;
           rdfs:comment "A generic event item, which is specialized in more specific classes." ;
           rdfs:label "Parameter" .

###  https://w3id.org/lkgb/log#TimeStamp
:TimeStamp rdf:type owl:Class ;
           rdfs:subClassOf :Parameter, time:Instant ;
           rdfs:comment "A timestamp associated with an event." ;
           rdfs:label "Timestamp" .


###  https://w3id.org/lkgb/log#Address
:Address rdf:type owl:Class ;
         rdfs:subClassOf :Parameter ;
         rdfs:comment "A logical address in a network, such as an IP address or a MAC address." ;
         rdfs:label "Network Address" .


###  https://w3id.org/lkgb/log#Application
:Application rdf:type owl:Class ;
             rdfs:subClassOf :Parameter ;
             rdfs:comment "An application, such as a web server, a database, etc." ;
             rdfs:label "Application" .


###  https://w3id.org/lkgb/log#File
:File rdf:type owl:Class ;
      rdfs:subClassOf :Parameter ;
      rdfs:comment "A file, such as a configuration file, a data file, etc." ;
      rdfs:label "File" .


###  https://w3id.org/lkgb/log#Process
:Process rdf:type owl:Class ;
         rdfs:subClassOf :Parameter ;
         rdfs:comment "An operating system process, such as a daemon, a service, etc." ;
         rdfs:label "Process" .


###  https://w3id.org/lkgb/log#URL
:URL rdf:type owl:Class ;
     rdfs:subClassOf :Parameter ;
     rdfs:comment "A URL, e.g. leading to a web page, a file, etc." ;
     rdfs:label "URL" .


###  https://w3id.org/lkgb/log#User
:User rdf:type owl:Class ;
      rdfs:subClassOf :Parameter ;
      rdfs:comment "A user account, such as a local user, a domain user, etc." ;
      rdfs:label "User Account" .

